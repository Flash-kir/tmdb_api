# tmdb_api
Упражнение на чтение кода. Фильмы с TMDB

## find_similar.py

Программа запрашивает от пользователя путь к базе данных фильмов. 
Если база не найдена выводит сообщение:

    'File not found, sorry...'

Если база данных существует от позьзователя запрашивается название фильма для поиска.
Если фильм не найден выходит сообщение:

    'No such film in FilmsDB'

Если фильм или фильмы найдены выводит список из 10 рекомендованных фильмов по убыванию рейтинга.

### find_my_film

Функция получает на вход аргументы:
- keyword - поисковая фраза от пользователя
- films_data - база данных фильмов

В цикле проверяются все названия фильмов на наличие поисковой фразы в названии фильма.
Возвращается первый фильм, в котором найдено совпадение.

### get_rating

Функция получает на вход аргументы:
- my_film - фильм из базы данных фильмов
- films_data - база данных фильмов

Программа сравнивает фильм, полученный на вход со всеми фильмами в базе данных
по совпадению бюджета, языка, жанра и входжению в одну серию фильмов
и начисляет рейтинг каждому фильму с зазными весами.
Возвращает список фильмов по убыванию рейтинга.

## hello_api_TMDB.py

Программа получает api ключ пользователя и делает пробный запрос к базе данных tmdb.
В случае если ключ не получен выходит сообщение:

    'Invalid api key'

В случае получения ключа выполняется запрос в сервис tmdb и выводится бюджет фильма с номером 215.

## tmdb_helpers.py

Файл содержит общие функции для работы с api сервиса tmdb:
- make_tmdb_api_request - подготавливает параметры для запроса к БД, возвращает данные, полученные функцией `load_json_data_from_url` с подготовленными параметрами.
- load_json_data_from_url - выполняет запрос к БД, возвращает данные в json формате.
- get_user_api_key - отправляет запрос к БД tmdb с ключем, введенным пользователем. Если запрос выполнен без ошибок возвращает ключ пользователя, иначе вызывает ошибку.

### load_json_data_from_url

Функция получает на вход аргументы:
- base_url - url адрес запроса
- url_params - параметры запроса

Выполняет запрос с полученными параметрами, возвращает ответ в json формате

### make_tmdb_api_request

Функция получает на вход аргументы:
- method - метод api сервиса tmdb
- api_key - api ключ пользователя
- extra_params - словарь параметров, по умолчанию имеет пустое значение

Если на вход не получены параметры, то формируются параметры с api ключом и языком, если параметры получены, то к ним добавляются сформированные.
Собирается url запроса.
Возвращается результат выполнения функциии `load_json_data_from_url` с подготовленными параметрами.

### get_user_api_key

Функция запрашивает от пользователя api ключ.
Выполняет c ключом запрос на метод `'/movie/2'` с помощью функции `make_tmdb_api_request`.
Если запрос выполнен без ошибок возвращает ключ пользователя, иначе вызывает ошибку.

## make_own_db.py

Файл запрашивает api ключ пользователя tmdb, проверяет его, в случае успеха выводит сообщение

    'please, wait, this operation may take smth like 15-20 minutes'
    
Выполняет запрос на скачивание 1000 фильмов с БД tmdb и сохраняет их в файл `'MyFilmDB.json'`.

### load_films

Функция получает на вход аргументы:
- user_api_key - api ключ пользователя
- films_amount - количество фильмов, по умолчанию 1000

В цикле выполняется запрос к БД tmdb с номером каждого фильма от 1 до `films_amount`. Если фильм существует - информация о нем добавляется в список.
Возвращает список фильмов.

## own_db_helpers.py

Файл содержит общие функции для работы с локальной базой данных:
- load_data - открывает БД по указаному пути и возвращает данные в json формате.

### load_data

Функция получает на вход аргумент:
- path - путь к локальной БД

Если БД не найдена возвращает пустое значение.
В случае если БД существует - открывает файл на чтение и возвращает содержимое в формате json.

## search_in_db.py

Файл запрашивает ключ к локально БД пользователя, открывает файл БД.
В случае отсутствия файла по введенному пути выходит сообщение:

    'File not found, sorry...'
    
В случае успеха от пользователя запрашивается название фильма для поиска и выводится список найденных фильмов.

### search_for_film

Функция получает на вход аргументы:
- keyword - поисковая фраза от пользователя
- films_data - данные фильмов с локальной БД

Функция проходит циклом по всем фильмам из полученных данных, выполняет поиск, полученной от пользователя, фразы в названии фильма, 
в случае успеха добавляет название фильа в список найденных фильмов.
Возвращает список названий найденных фильмов.
